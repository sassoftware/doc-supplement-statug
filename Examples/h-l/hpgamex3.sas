/****************************************************************/
/*          S A S   S A M P L E   L I B R A R Y                 */
/*                                                              */
/*    NAME: hpgamex3                                            */
/*   TITLE: Example 3 for PROC GAMPL                            */
/*    DESC: Mackerel egg survey data set                        */
/*     REF: Bowman and Azzalini (1997)                          */
/* PRODUCT: STAT                                                */
/*  SYSTEM: ALL                                                 */
/*    KEYS:                                                     */
/*   PROCS: GAMPL                                               */
/*                                                              */
/****************************************************************/

title 'Mackerel Egg Density Study';
data Mackerel;
   input Egg_Count Longitude Latitude  Net_Area Depth Distance;
   datalines;
   0     -4.65     44.57     0.242    4342    0.8395141177
   0     -4.48     44.57     0.242    4334    0.8591926336
   0      -4.3     44.57     0.242    4286    0.8930152895
   1     -2.87     44.02     0.242    1438    0.3956408691
   4     -2.07     44.02     0.242     166    0.0400088237
   3     -2.13     44.02     0.242     460    0.0974234463
   0     -2.27     44.02     0.242     810    0.2362566569
   1     -2.35     44.02     0.242     887    0.3160524314
   0     -2.42     44.02     0.242     946    0.3859431039
   0     -2.48     44.02     0.242    1012    0.4254223762
   0     -2.48     44.12     0.242    1011    0.4612031784
   0     -2.33     44.12     0.242     969    0.3185483454
   0     -2.27     44.12     0.242     929    0.2622465816
   2      -2.2     44.12     0.242     847    0.1965611905
   0     -2.13     44.12     0.242     704    0.1308757994
   1     -2.07     44.12     0.242     266    0.0745740357
   3     -2.07     44.37     0.242     181    0.0737069183
   1     -2.13     44.37     0.242     467    0.1308511425
   0      -2.2     44.37     0.242     696    0.1979967228
   0     -2.35     44.37     0.242    1012    0.3454873183
   0     -2.35     44.62     0.242    1335    0.3423067093
   0     -2.27     44.62     0.242     922    0.2623067093
   0     -2.18     44.62     0.242     606    0.1723067093
   0     -2.13     44.62     0.242     539    0.1223067093
   2     -2.07     44.62     0.242     883    0.0623067093
   1     -2.07     44.87     0.242     135    0.0268741384
   0     -2.13     44.88     0.242     147    0.0395908028
   0      -2.2     44.87     0.242     268    0.0806910854
   1     -2.27     44.87     0.242     783    0.1304256852
   0     -2.35     44.87     0.242    1892    0.1937029682
   0     -2.42     44.87     0.242    2034    0.2299645979
   0     -2.48     44.87     0.242    2580    0.2492961559
   0     -2.55     44.87     0.242    2709     0.271376999
   0     -2.62     44.87     0.242    2681    0.2823344738
   0      -2.7     44.87     0.242    2879     0.311043345
   0     -2.77     44.87     0.242    2852    0.3199188326
   0     -2.83     44.87     0.242    3158    0.3239188078
   0      -2.9     44.87     0.242    2943    0.3376793441
   0     -2.97     44.87     0.242    3097    0.3526674424
   0     -3.12     44.98     0.242    2249    0.3063093929
   0     -3.27     45.12     0.242    1202    0.2996330778
   0      -3.2     45.12     0.242     964    0.2504312196
   0     -3.13     45.12     0.242     161    0.2088774779
   0     -3.05     45.12     0.242    1039    0.1534121987
   1     -2.98     45.12     0.242     242    0.1157074109
   2     -2.92     45.12     0.242    1159     0.098536924
   0     -2.85     45.12     0.242     155    0.0866991148
   4     -2.77     45.12     0.242     156    0.0704395178
   0      -2.7     45.12     0.242     306    0.0614082461
   1     -2.63     45.12     0.242     126    0.0568025763
   0     -2.55     45.12     0.242     127    0.0232507398
   0     -2.48     45.12     0.242     125    0.0146964787
   0     -2.42     45.12     0.242     126    0.0003367127
   0     -2.35     45.12     0.242     120    0.0294471811
   0     -2.27     45.12     0.242     120    0.0562913573
   1      -2.2     45.12     0.242     116    0.0907005137
   0     -2.13     45.12     0.242     111    0.1334280664
   0     -2.07     45.12     0.242     104    0.1807325361
   0     -1.98     45.12     0.242     100    0.2388023189
   0     -1.92     45.12     0.242      95     0.262181456
   0     -1.78     45.12     0.242      79    0.3414250436
   0      -1.7     45.12     0.242      71    0.3992517839
   2     -1.57     45.12     0.242      60    0.5062630171
   0     -1.48     45.12     0.242      52    0.5858216749
   0     -1.42     45.12     0.242      40    0.6403984929
   0     -1.35     45.12     0.242      31     0.705185997
   0     -1.28     45.12     0.242      26    0.7708854332
   0     -1.28     45.18     0.242      27    0.7927131334
   0     -1.28     45.25     0.242      27    0.8229897728
   0     -1.28      45.3     0.242      29    0.8474984563
   0     -1.28     45.37     0.242      29    0.8854217569
   0     -1.37     45.37     0.242      35    0.8130725031
   0     -1.42     45.37     0.242      41    0.7744788998
   0     -1.48     45.37     0.242      46    0.7299961447
   0     -1.57     45.37     0.242      51    0.6678394859
   0     -1.63     45.37     0.242      51    0.6301479065
   0     -1.72     45.37     0.242      56    0.5797984059
   0     -1.78     45.37     0.242      66    0.5486850531
   0     -1.85     45.37     0.242      74    0.5087696952
   0     -1.92     45.37     0.242      78    0.4586245543
   1     -1.98     45.37     0.242      82    0.4201861232
   0     -2.07     45.37     0.242      92    0.3721646287
   0     -2.13     45.37     0.242      97     0.342784142
   0      -2.2     45.37     0.242     103    0.3135403699
   0     -2.28     45.52     0.242     102    0.4233335102
   0     -2.28     45.62     0.242      99    0.5184856328
   0      -2.2     45.62     0.242      92    0.5450129543
   1     -2.12     45.62     0.242      83    0.5759822965
   4     -2.07     45.62     0.242      79    0.5937739873
   0     -1.35     45.43     0.242      31    0.8666743262
   4     -1.35      45.3     0.242      34     0.788210995
   0     -1.35     45.23     0.242      33     0.751903264
   0     -1.42     45.23     0.242      41    0.6915066578
   1     -1.48     45.23     0.242      50    0.6412942093
   0     -1.57     45.25     0.242      57    0.5825376018
   2     -1.63     45.23     0.242      63    0.5248335695
   3      -1.7     45.25     0.242      68     0.492391919
   3     -1.78     45.25     0.242      74    0.4464470693
   0     -1.85     45.25     0.242      77    0.4098291238
   0     -1.92     45.23     0.242      84    0.3628981859
   0     -1.98     45.25     0.242      90    0.3319200273
   1     -2.13     45.25     0.242     105    0.2382686636
   0     -2.28     45.37     0.242     108    0.2844304813
   0     -2.35     45.37     0.242     108    0.2590744601
   1     -2.48     45.37     0.242     112    0.2307815007
   0     -2.63     45.37     0.242     120    0.1892521557
   0      -2.7     45.37     0.242     124    0.1835552819
   0     -2.77     45.37     0.242     133    0.1740475352
   1     -2.85     45.37     0.242     130    0.1562860501
   1     -2.92     45.37     0.242     139    0.1168201072
   0     -2.98     45.37     0.242     136    0.0815351079
   1     -3.05     45.37     0.242     147    0.0288824077
   5     -3.13     45.37     0.242     158     0.016790237
   0      -3.2     45.37     0.242     178    0.0520579023
   0     -3.27     45.37     0.242     592    0.1161080566
   9     -3.35     45.37     0.242     941    0.1943987105
   2     -3.42     45.37     0.242    2570    0.2512595743
   0     -3.48     45.37     0.242    3200     0.291093129
   0     -3.55     45.37     0.242    3527    0.3417890342
   0     -3.62     45.37     0.242    3611    0.3886139984
   0      -3.7     45.37     0.242    3723    0.4367806449
   0     -3.83     45.37     0.242    3691    0.5179946065
   0     -3.98     45.37     0.242    3960    0.6130237854
   2     -4.12     45.52     0.242    3789    0.5976801872
   5     -4.27     45.62     0.242    3964    0.6042301961
   1      -4.2     45.62     0.242    4015    0.5667162652
   1     -4.13     45.62     0.242    3498    0.5295171301
   2     -4.05     45.62     0.242    2602    0.4804855719
   0     -3.98     45.62     0.242    2183    0.4257784423
   0     -3.92     45.62     0.242    1879    0.3805299042
   1     -3.85     45.62     0.242    2354    0.3336735257
   1     -3.78     45.62     0.242    1794    0.2951277304
   1      -3.7     45.62     0.242    2101    0.2532669769
   2     -3.63     45.62     0.242    1294    0.2003720056
   1     -3.55     45.62     0.242    1144    0.1468598219
   0     -3.48     45.62     0.242     419    0.1047140062
   0     -3.42     45.62     0.242     169    0.0685890213
   0     -3.35     45.62     0.242     148    0.0245552715
   1     -3.27     45.62     0.242     136     0.033385505
   1      -3.2     45.62     0.242     135    0.0716968847
   0     -3.13     45.62     0.242     139     0.102588002
   1     -3.07     45.62     0.242     133     0.147611337
   0     -2.98     45.62     0.242     133    0.2241105112
   1     -2.92     45.62     0.242     125    0.2762483085
   0     -2.77     45.62     0.242     121     0.403859887
   0      -2.7     45.62     0.242     121    0.4321757844
   0     -2.63     45.62     0.242     117    0.4391348184
   0     -2.57     45.62     0.242     114    0.4444086724
   0     -2.48     45.62     0.242     112    0.4648272796
   0     -2.42     45.62     0.242     106    0.4830717505
   0      -2.2     45.48     0.242      90    0.4181302423
   0     -2.07     45.52     0.242      82    0.5033368395
   1     -2.07     45.87     0.242      73    0.8261550822
   0     -2.13     45.87     0.242      77    0.8032848849
   5      -2.2     45.87     0.242      79    0.7809725901
   6     -2.28     45.87     0.242      84    0.7587625502
   0     -2.35     45.87     0.242      91    0.7419150329
   0     -2.42     45.87     0.242      98    0.7218872066
   0     -2.48     45.87     0.242      98    0.7071149818
   0     -2.57     45.87     0.242     101    0.6924753269
   0      -2.7     45.87     0.242     106    0.5941331548
   0     -2.85     45.87     0.242     114    0.4767936492
   1     -2.98     45.87     0.242     120    0.3934782059
   0     -3.13     45.87     0.242     123    0.3075686928
   0     -3.28     45.87     0.242     135    0.2153109709
   0     -3.35     45.87     0.242     138    0.1731651552
   0     -3.42     45.87     0.242     138     0.117052398
   0     -3.48     45.87     0.242     139    0.0776678955
   0     -3.57     45.87     0.242     137    0.0278001088
   1     -3.63     45.87     0.242     151    0.0035954563
   1      -3.7     45.87     0.242     180    0.0533279819
   0     -3.78     45.87     0.242     175    0.1171976208
   1     -3.85     45.87     0.242     934    0.1603654846
   1     -3.92     45.87     0.242     598     0.203268098
   1     -3.98     45.87     0.242    1003    0.2387012687
   1     -4.07     45.87     0.242    1972    0.2857047672
   0     -4.13     45.87     0.242    2443    0.3188313644
   0      -4.2     45.87     0.242    2323    0.3644993417
   3     -4.28     45.87     0.242    3024    0.4196773185
   0     -4.35     45.87     0.242    3463    0.4618545078
   0     -4.42     45.87     0.242    4097    0.5036019328
   0     -4.57     45.87     0.242    4142     0.579097532
   0     -4.63     45.87     0.242    3640    0.6019552966
   0      -4.8     46.02     0.242    3496    0.5597152007
   1     -4.95     46.12     0.242    3883    0.5075978088
   0     -4.88     46.12     0.242    2765    0.5060715332
   0     -4.73     46.12     0.242    2254    0.4377232045
   1     -4.58     46.12     0.242    2208    0.3536401867
   2     -4.52     46.12     0.242    3518    0.3292787693
   0     -4.45     46.12     0.242    1581    0.3017949176
  18     -4.37     46.12     0.242    1346    0.2754879266
   8      -4.3     46.12     0.242    1698    0.2441731581
   6     -4.23     46.12     0.242    1200    0.1903899909
   1     -4.15     46.12     0.242    1220    0.1425503662
   0     -4.08     46.12     0.242     189     0.100714452
   1     -4.02     46.12     0.242     154    0.0593309693
   0     -3.93     46.12     0.242     151    0.0002530401
   0     -3.87     46.12     0.242     148    0.0319942153
   7      -3.8     46.12     0.242     152    0.0684702687
   0     -3.72     46.12     0.242     147    0.1168519893
   0     -3.65     46.12     0.242     141    0.1597546027
   0     -3.58     46.12     0.242     138    0.2029447134
   0     -3.48     46.12     0.242     137    0.2691384918
   0     -3.43     46.12     0.242     133     0.308403784
   0     -3.37     46.12     0.242     133    0.3455591358
   0     -3.28     46.12     0.242     128    0.3973143043
   0     -3.15     46.12     0.242     121    0.4847632693
   0     -2.98     46.12     0.242     117    0.5955562612
   0     -2.92     46.12     0.242     111    0.6337804213
   0     -2.72     46.12     0.242     102    0.7491849225
   0     -2.57     46.12     0.242      94    0.8520211674
   0     -2.48     46.12     0.242      84    0.9199659139
   0     -2.42     46.08     0.242      71    0.9252948749
   0     -2.35     46.08     0.242      64     0.942760965
   2     -2.28     46.08     0.242      51    0.9632590156
   2     -2.22     46.12     0.242      56    1.0158612029
   0     -2.13     46.12     0.242      58    1.0403837629
   0     -2.07     46.12     0.242      54     1.058953803
   0     -2.07     46.37     0.242      36    1.2967971616
   0     -2.22     46.37     0.242      41    1.2575435305
   0     -2.35     46.37     0.242      54    1.1838425346
   0     -2.48     46.37     0.242      67    1.0949776534
   0     -2.57     46.37     0.242      73    1.0385465076
   0     -2.63     46.37     0.242      83    1.0036503573
   0     -2.72     46.37     0.242      83    0.9536377808
   0     -2.87     46.37     0.242     100    0.8601297509
   0     -2.98     46.37     0.242     108      0.78150727
   0     -3.15     46.37     0.242     113    0.6763897421
   0     -3.22     46.37     0.242     117    0.6296923646
   0     -3.28     46.37     0.242     119    0.5871112624
   0     -3.37     46.37     0.242     119    0.5292610219
   0     -3.43     46.37     0.242     124    0.4922171758
   1     -3.52     46.37     0.242     124    0.4369720766
   0     -3.58     46.37     0.242     127     0.400198408
   0     -3.65     46.37     0.242     133    0.3600092117
   0     -3.73     46.37     0.242     136    0.3183222936
   0      -3.8     46.37     0.242     138    0.2734263915
   0     -3.87     46.37     0.242     139    0.2251456617
   0     -3.95     46.37     0.242     139    0.1645040131
   0     -4.02     46.37     0.242     141    0.0999022176
   0     -4.08     46.37     0.242     145    0.0557048402
   0     -4.17     46.37     0.242     148     0.009411632
   0     -4.23     46.37     0.242     154    0.0024671392
   0      -4.3     46.37     0.242     151    0.0163257056
   0     -4.38     46.37     0.242     153    0.0468258082
   1     -4.45     46.37     0.242     166    0.0720718139
   1     -4.53     46.37     0.242     360    0.1178848997
   5      -4.6     46.37     0.242     690    0.1670144382
  12     -4.67     46.37     0.242     914    0.2013499642
  13     -4.73     46.37     0.242    1317    0.2339516795
   0     -4.82     46.37     0.242    1330     0.249429604
   0     -4.88     46.37     0.242    1699    0.2575978088
   0     -4.95     46.37     0.242    2198    0.2575978088
   0     -5.03     46.37     0.242    2402    0.2664339843
   0      -5.1     46.37     0.242    2580    0.2921852719
   0     -5.17     46.37     0.242    2866    0.3019951109
   0     -5.25     46.37     0.242    3291    0.3186299755
   0     -5.32     46.37     0.242    3370    0.3446143006
  16     -5.47     46.52     0.242    3198    0.3327686065
   1     -5.62     46.62     0.242    3793    0.4284737606
   1     -5.55     46.62     0.242    3225    0.3668810962
   8     -5.47     46.62     0.242    2776    0.2900961236
  14      -5.4     46.62     0.242    2523    0.2247566026
   2     -5.33     46.62     0.242    2867    0.1621795694
   0     -5.25     46.62     0.242    1721    0.0949067619
   6     -5.18     46.62     0.242    1985    0.0602167335
   4      -5.1     46.62     0.242    1841    0.0466900789
   2     -5.03     46.62     0.242    1152    0.0375872025
  11     -4.97     46.62     0.242     667    0.0104181925
   0     -4.67     46.62     0.242     158    0.0188133483
   1     -4.88     46.62     0.242     388    0.0075978088
  16     -4.82     46.62     0.242     271    0.0075978088
   0     -4.73     46.62     0.242     189    0.0157147106
   2      -4.6     46.62     0.242     154    0.0242108657
   0     -4.53     46.62     0.242     150    0.0526485479
   0     -4.45     46.62     0.242     145     0.114848174
   2     -4.38     46.62     0.242     145    0.1597245396
   0     -4.32     46.62     0.242     143    0.2061424875
   0     -4.23     46.62     0.242     144    0.2393055029
   0     -4.17     46.62     0.242     141    0.2544631712
   0      -4.1     46.62     0.242     138    0.2684337243
   0     -4.02     46.62     0.242     136    0.2969379548
   1     -3.95     46.62     0.242     135    0.3350550567
   0     -3.88     46.62     0.242     132    0.3754848747
   0      -3.8     46.62     0.242     127    0.4286142415
   0     -3.73     46.62     0.242     121    0.4812393222
   0     -3.67     46.62     0.242     125    0.5295585358
   0     -3.58     46.62     0.242     120     0.605965081
   0     -3.52     46.62     0.242     113    0.6411264252
   0     -3.45     46.62     0.242     117    0.6785672801
   0     -3.37     46.62     0.242     118    0.7264474401
   0      -3.3     46.62     0.242     115    0.7693500535
   0     -3.22     46.62     0.242     108    0.8185334843
   0     -3.15     46.62     0.242     108    0.8617513047
   0     -3.08     46.62     0.242     102    0.9066221601
   0     -2.98     46.62     0.242     100    0.9758680617
   0     -2.93     46.63     0.242      92    1.0157715232
   0     -2.87     46.62     0.242      86    1.0434127718
   0     -2.78     46.62     0.242      81    1.1010506764
   0     -2.65     46.62     0.242      68    1.1914064642
   0     -2.57     46.62     0.242      61     1.241979781
   0     -2.48     46.62     0.242      58    1.2948416274
   0     -2.42     46.62     0.242      51    1.3288640445
   0     -2.48     46.75     0.242      39    1.3997992726
   0     -2.48     46.87     0.242      27    1.4883573323
   0     -2.65     46.87     0.242      44    1.3759856056
   0     -2.72     46.87     0.242      51     1.333267116
   0      -2.8     46.87     0.242      53    1.2801998414
   0     -2.87     46.87     0.242      57     1.233030138
   0     -2.93     46.87     0.242      50    1.1943828874
   0     -2.97     44.37     0.242    1420    0.7456408691
   0      -2.9     44.37     0.242    1427    0.7456408691
   0     -2.83     44.37     0.242    1467    0.7456408691
   0     -2.68     44.37     0.242    1383    0.6716074698
   0     -2.62     44.37     0.242    1349    0.6123128968
   0     -2.55     44.37     0.242    1348     0.543135895
   0     -2.48     44.37     0.242    1328    0.4739588931
   0     -2.42     44.37     0.242    1492    0.4146643202
   0     -2.42     44.62     0.242    1735    0.4123067093
   0     -2.48     44.62     0.242    2080     0.453205233
   0     -2.62     44.62     0.242    2634    0.5280940138
   0     -2.77     44.62     0.242    2280    0.5662761939
   0      -2.9     44.62     0.242    2262    0.5811964535
   0     -4.33     45.48     0.242    4173    0.7543788285
   0     -4.35     45.58     0.242    3943    0.6828151146
   0     -4.42     45.62     0.242    4102    0.6972639723
   0     -4.48     45.62     0.242    4231    0.7386401851
   0     -4.63     45.62     0.242    4360    0.8300959169
   0     -4.77     45.62     0.242    4390    0.8866168813
   0     -4.83     45.62     0.242    4414    0.9125366692
  10     -5.75     48.25      0.15     124    0.9227330417
   4     -6.25     48.25      0.15     140    0.6897133782
   6      -6.8     48.23      0.15     160    0.5694966125
   8     -7.27     48.25      0.15     173    0.3675161731
   1     -7.78     48.25      0.15     184     0.125272891
  20     -8.23     48.27      0.15     206    0.0116115201
  20     -8.75     48.23      0.15     192    0.0877499994
  26     -9.25     48.25      0.15     256    0.1541522464
  22     -9.75     48.23      0.15     875    0.4171101972
  76    -10.27     48.25      0.15    3000    0.5375307864
  27    -10.77     48.25      0.15    2700    0.7401461724
  22    -11.25     48.25      0.15    4000    0.8738787306
  27    -11.73     48.23      0.15    2800     1.153986225
  51    -12.73     48.73      0.15    1600    1.6615010232
  21    -12.25     48.73      0.15    1300    1.2186671569
  29    -11.87     48.73      0.15    1400    0.8894291719
  81    -11.62     48.75      0.15    2600    0.6857238367
  65    -11.37     48.75      0.15    1600    0.5293366535
  53    -11.12     48.73      0.15    1000    0.3914502223
  61    -10.87     48.75      0.15    1100    0.2694969977
  28    -10.62     48.73      0.15    1400    0.2622425884
  23    -10.37     48.73      0.15     162    0.1179571067
  30    -10.07     48.75      0.15     425    0.0157432556
  45     -9.85     48.75      0.15     193     0.025306547
  43      -9.6     48.75      0.15     176     0.119013888
  51     -9.37     48.75      0.15     175    0.2067097778
  17     -9.13     48.75      0.15     165     0.329107796
   2     -8.87     48.73      0.15     170    0.3988589266
   6     -8.63     48.73      0.15     146    0.4214112795
  10     -8.23     48.75      0.15     153    0.4462789579
   5     -7.75     48.75      0.15     158    0.6032527898
  23     -7.23     48.75      0.15     153    0.8105988408
  10     -6.77     48.75      0.15     145      1.07455991
   3     -6.27     48.75      0.15     137    1.1596222107
   3     -6.73     49.25      0.15     126    1.4904395437
   7     -7.22     49.25      0.15     135    1.2631817058
  10     -7.72     49.25      0.15     138    1.0828571439
  15     -8.25     49.25      0.15     127    0.9321593173
  18     -8.63     49.25      0.15     152    0.9390438736
   4     -8.88     49.25      0.15     154     0.887526452
   1     -9.12     49.25      0.15     151    0.7629012711
  13     -9.38     49.25      0.15     153    0.6526316781
   9     -9.65     49.23      0.15     154    0.5327590071
  10     -9.88     49.25      0.15     132     0.499412191
  26    -10.15     49.25      0.15     162    0.3409200497
  33    -10.37     49.25      0.15     136    0.2579881877
  40    -10.63     49.25      0.15     163    0.2573486008
  40    -10.88     49.23      0.15     177    0.1556872456
  57    -11.08     49.25      0.15     187    0.0439525458
  41    -11.37     49.23      0.15     350    0.2139985205
  37    -11.73     49.25      0.15     830    0.5692610808
  32    -12.25     49.25      0.15    1100       1.0889355
  65    -12.75     49.25      0.15    1200      1.58882337
  55    -12.73     49.73      0.15    2200    1.6324447345
  57    -12.25     49.73      0.15    1200    1.1787450108
  59    -11.75     49.75      0.15     780    0.7545504793
  59    -11.33     49.73      0.15     450    0.3765631369
  43     -11.1     49.73      0.15     320    0.1580631431
  30    -10.83     49.75      0.15     175    0.0496397168
  24     -10.6     49.75      0.15     147    0.1960982386
  12    -10.35     49.75      0.15     143    0.4192402102
  45    -10.08     49.75      0.15     141    0.6815092188
  40     -9.85     49.73      0.15     131    0.9051489134
  33     -9.62     49.73      0.15     158     1.030266117
  21     -9.33     49.73      0.15     118    1.1073121557
   4     -9.12     49.75      0.15     142    1.2157726486
   6     -8.85     49.75      0.15     126    1.3310745619
   3      -8.6     49.75      0.15     136    1.4377120457
   0      -8.2     49.75      0.15     138    1.4344814083
   3     -7.72     49.73      0.15     133    1.5342936614
   5     -7.73     50.25      0.15     103    2.0258870905
   0     -8.23     50.25      0.15     129    1.9293283944
  35     -8.73     50.25      0.15     126      1.83164208
  60     -9.23     50.25      0.15     140    1.4756778835
  46     -9.75     50.25      0.15     126    0.9658144214
  19     -10.1     50.23      0.15     137    0.6396928347
   9    -10.37     50.23      0.15     147    0.3980227523
   8    -10.62     50.23      0.15     164    0.1488695265
   5    -10.87     50.23      0.15     208     0.052118011
  56    -11.13     50.23      0.15     550    0.2380892631
  34    -11.38     50.23      0.15    1100    0.4783387553
  31    -11.73     50.25      0.15    1600    0.8269773693
  31    -12.25     50.25      0.15    2300    1.3439881777
  28    -12.75     50.23      0.15    2400    1.8415845371
  30    -12.75     50.75      0.15    2300    1.7069865241
  35    -12.25     50.73      0.15    2100    1.2328347626
  32    -11.87     50.75      0.15    2000    0.8753594353
  23     -11.6     50.73      0.15    1800    0.6519149416
  42    -11.37     50.75      0.15    1300    0.4537462859
  31    -11.12     50.73      0.15     330    0.2509354095
  28    -10.85     50.73      0.15     181    0.0218147471
  18    -10.55     50.73      0.15     166    0.2238786395
  10    -10.23     50.75      0.15     140    0.5199212285
   1     -9.72     50.75      0.15     123    1.0027754255
  20     -9.23     50.73      0.15     130    1.4775126146
  18     -8.73     50.73      0.15     105    1.9723065827
   0     -8.25     50.73      0.15     118    2.4071712185
   1     -8.25     51.25      0.15     101    2.5543951991
   2     -8.75     51.23      0.15     105    2.0742430025
   1     -9.25     51.25      0.15     110    1.6168704133
   2     -9.75     51.25      0.15     108    1.1773817858
   6    -10.25     51.23      0.15     136    0.7520089099
  12    -10.63     51.23      0.15     165    0.4279458648
  17    -10.88     51.25      0.15     178    0.2277079773
  58     -11.3     51.23      0.15     211    0.1922920227
  35    -11.65     51.23      0.15     610    0.5422920227
  78    -11.88     51.25      0.15    1100    0.7722920227
  35    -12.12     51.25      0.15    1200    1.0122920227
  29    -12.38     51.25      0.15    1300    1.2688766929
  69    -12.75     51.23      0.15    1500    1.5990568921
  14    -14.73     51.75      0.15     470    1.6548107034
  22    -14.35     51.73      0.15     375    1.5657689486
  29    -14.08     51.73      0.15     380     1.532859219
  54    -13.85     51.75      0.15     450    1.5175848241
  84    -13.62     51.73      0.15     590    1.5535554343
  46    -13.37     51.73      0.15     790    1.5816110843
  67    -13.12     51.73      0.15    1000    1.4404489283
  66    -12.88     51.73      0.15    1200    1.2811801214
  53    -12.62     51.75      0.15    1300    1.1187514574
  50    -12.38     51.75      0.15    1300    1.0045057132
  37    -12.12     51.73      0.15    1000    0.7998552594
  43    -11.88     51.75      0.15     710    0.5857323005
  36    -11.62     51.73      0.15     350     0.370994499
  46    -11.35     51.73      0.15     210    0.1361486674
  15     -11.1     51.75      0.15     183    0.0911692879
  24    -10.73     51.75      0.15     133    0.4272116779
   1     -8.23     51.23     0.222     101    2.5676033688
   0     -8.73     51.25     0.222     104    2.0998144654
   0     -9.23     51.25     0.222     105    1.6351086518
   2     -9.73     51.25     0.222     102    1.1945402346
  14    -10.23     51.25     0.222     133    0.7790685494
  23    -10.72     51.25     0.222     171    0.3647873377
  12    -11.22     51.23     0.222     203    0.1122920227
  78    -11.72     51.25     0.222    1161    0.6122920227
  90    -12.18     51.25     0.222    1645    1.0722920227
  77     -12.7     51.23     0.222    1885    1.5566992609
  33     -14.7     51.73     0.222     481    1.6622082011
  63    -14.28     51.75     0.222     377    1.5330746563
  46    -13.78     51.73     0.222     509    1.5429208526
  77    -13.28     51.73     0.222     912    1.5581619751
  41    -12.78     51.73     0.222    1085    1.2226241241
  73    -12.28     51.75     0.222     996    0.9253871512
  56    -11.77     51.73     0.222     523    0.5014644054
  16    -11.28     51.73     0.222     195     0.075262711
  11    -10.78     51.75     0.222     138    0.3802056563
   1     -10.3     51.75     0.222      68    0.8359314684
   3     -10.7     52.23     0.222     117    0.6759237064
   2     -11.2     52.25     0.222     139    0.2560062999
  26     -11.7     52.23     0.222     306     0.173370354
  66    -12.23     52.25     0.222     749    0.4886975668
  52    -12.72     52.25     0.222     689    0.7945254084
  76     -13.2     52.25     0.222     572    1.1112249253
  51     -13.7     52.23     0.222     387    1.0493084143
  37     -14.2     52.23     0.222     334    1.0464541627
  43    -14.68     52.25     0.222     436    1.1825388824
  73    -14.78     52.73     0.222     559    0.8758632468
  24    -14.28     52.75     0.222     332    0.5597685007
  47    -13.78     52.75     0.222     234    0.5251552118
  53    -13.28     52.73     0.222     347    0.6369096605
  57     -12.8     52.73     0.222     487    0.6172359158
  41    -12.28     52.75     0.222     337    0.1365312648
   1    -11.78     52.75     0.222     168    0.1552061145
   4    -11.27     52.73     0.222     130    0.4742166919
   1    -11.25     53.22     0.222     143    0.6238153661
   4    -11.68     53.25     0.222     182    0.3563155715
  10     -12.2     53.23     0.222     308    0.0094483276
  33     -12.7     53.25     0.222     338    0.4857796791
  32     -13.2     53.23     0.222     236    0.2341923116
  50    -13.68     53.23     0.222     171     0.055459343
  47     -14.2     53.25     0.222     208    0.1030179144
  53     -14.7     53.25     0.222     949    0.5948816159
 113    -14.75     53.72     0.222    1500    0.7661087538
  27    -14.28     53.75     0.222    1358     0.424455318
  44     -13.8     53.75     0.222     418     0.190150346
  37    -13.28     53.75     0.222     303    0.1171377308
  19    -12.77     53.73     0.222     283    0.4356861554
  21    -12.28     53.73     0.222     333    0.3994867254
  17    -11.77     53.73     0.222     295     0.082376324
  13     -11.3     53.75     0.222     205    0.1453250442
  21    -10.78     53.75     0.222     148    0.4245712891
   0    -10.27     53.75     0.222      74    0.6732115349
   0    -10.27     53.27     0.222     107    1.0927471177
   1    -10.72      53.2     0.222     119     0.928502272
   0    -10.75     52.75     0.222     123    0.9018657597
   2    -10.27     52.73     0.222     100    1.2989060637
   0    -10.22     54.25     0.222      92    0.3025224369
  58    -10.72     54.25     0.222     214    0.0175548779
  62     -11.2     54.25     0.222     340    0.2170562127
  34    -11.73     54.25     0.222    1172    0.5054580427
  49     -12.2     54.23     0.222    2030    0.7386455951
  24     -12.7     54.23     0.222    2200    0.8056505265
  16    -12.27     54.73     0.222    2000    1.1964552871
  10    -11.78     54.75     0.222    2873    0.9476267756
  13     -11.3     54.75     0.222    2900    0.7019613094
  43    -10.78     54.75     0.222    1750    0.4384999915
  42    -10.28     54.75     0.222     120    0.0331852024
  27     -9.73     54.73     0.222     100    0.3910312491
   0     -9.28     54.75     0.222      91    0.6847841032
   0     -8.25     55.23     0.222      32    1.0048444388
   1      -8.7     55.23     0.222      93    0.6555891558
   8     -9.22     55.25     0.222     109    0.2937613708
  27     -9.72     55.25     0.222     128    0.0318280984
  32    -10.18     55.23     0.222    1291    0.2745622713
  19    -10.65     55.23     0.222    2480    0.6214210959
  42    -10.27     55.73     0.222    2300    0.6827875476
  40     -9.78     55.75     0.222    1785    0.4312701461
  30     -9.27     55.73     0.222     140    0.1006893438
   7     -8.77     55.73     0.222     106    0.3264369189
   3     -8.28     55.73     0.222     104    0.8082043186
   1     -8.23     56.25     0.222     167    0.6484234451
   2     -8.72     56.23     0.222     131    0.2596481931
  27      -9.2     56.25     0.222     711    0.1909803452
 106     -9.68     56.23     0.222    1595    0.6582792428
  22     -9.77     56.75     0.222    1795    0.6673417415
  70     -9.28     56.75     0.222    1260    0.3117001765
   7     -8.78     56.73     0.222     117    0.0667314293
   4     -8.73     57.23     0.222     134       0.3715636
  37     -9.18     57.23     0.222     174     0.082095629
  37      -9.7     57.25     0.222    1940    0.3656364314
  49     -9.77     57.75     0.222    1088    0.3920204076
   3     -9.27     57.75     0.222     144    0.0873164841
   6     -8.78     57.75     0.222     146    0.3649476732
   3     -8.28     57.73     0.222     111    0.5841104348
   0     -8.23     57.27     0.222     133    0.8039890158
   1     -8.25     56.77     0.222     132    0.5666356525
   1     -5.75     48.25      0.19     120    0.9227330417
  10     -6.23     48.25      0.19     139    0.6979037904
  10     -6.75     48.25      0.19     155    0.5913811675
   3     -7.25     48.25      0.19     172    0.3821368185
  10     -7.75     48.25      0.19     177    0.1366381488
  16      -7.8     48.25      0.19     178    0.1176960525
  11     -8.25     48.25      0.19     205    0.0357602758
 140     -8.75     48.25      0.19     200    0.0678410534
 122      -8.8     48.25      0.19     190    0.0726067329
  24     -9.23     48.25      0.19     560    0.1428536135
  14     -9.25     48.25      0.19     520    0.1541522464
  41     -9.75     48.25      0.19     775    0.3980794402
  22     -9.77     48.25      0.19     906    0.4042300733
  75    -10.23     48.25      0.19    2000    0.5276628557
  44    -10.23     48.25      0.19    2000    0.5276628557
  87    -10.73     48.25      0.19    1800     0.716775297
  57    -10.75     48.25      0.19    1900    0.7282798854
  72    -11.25     48.25      0.19    3600    0.8738787306
  38    -11.73     48.25      0.19    3000    1.1389598949
   8    -10.77     47.75      0.19    2000    1.1697823809
   7    -10.25     47.75      0.19    2000    1.0242227267
   5     -9.75     47.75      0.19    4450    0.8437334395
  15     -9.23     47.75      0.19    3500    0.6031973168
  34     -8.73     47.75      0.19    2500    0.5636584298
  50     -8.27     47.75      0.19    1560    0.5147870417
  72     -8.23     47.75      0.19    1350    0.5011520938
  52     -7.77     47.75      0.19     900    0.3179692814
  50     -7.75     47.75      0.19     770    0.3066726343
  12     -7.25     47.75      0.19     176     0.017722909
   6     -6.75     47.75      0.19     167    0.0946135503
   2     -6.27     47.75      0.19     152    0.2511573132
   2     -5.75     47.75      0.19     134    0.4343295287
   0     -5.23     47.75      0.19     125    0.6090585857
   1     -4.75     47.75      0.19     100    0.9150075624
   2     -4.73     47.25      0.19     122    0.6274923845
   0     -5.25     47.25      0.19     140    0.2096735702
   0     -5.73     47.25      0.19     200    0.0660511438
   0     -5.75     47.25      0.19     224    0.0650769018
   9     -6.23     47.25      0.19    1314    0.1760703613
  28     -6.28     47.25      0.19    1115    0.1976657775
 133     -6.75     47.25      0.19    2300    0.4015999827
  53     -7.25     47.25      0.19    2500    0.4495331185
  40     -7.32     47.25      0.19    2500    0.4666956288
  15     -7.73     47.25      0.19    3000    0.6422156047
  18     -8.25     47.25      0.19    3000    0.9769665902
   0     -8.73     47.25      0.19    3000    1.0610467794
   4     -9.25     47.25      0.19    3000    1.0987471315
   3     -9.73     47.25      0.19    3000    1.2601360266
   2    -10.23     47.25      0.19    3000    1.5026291941
  10     -8.25     46.75      0.19    4000    1.3529101749
   1     -7.75     46.75      0.19    4000    1.0985733569
  23     -7.23     46.75      0.19    4000    0.9368645063
  24     -6.73     46.75      0.19    2000    0.8485726594
  19     -6.25     46.75      0.19    2000     0.640094992
   5     -6.18     46.75      0.19    2000    0.6146546419
  20     -5.78     46.75      0.19    2000    0.4411973968
  38     -5.73     46.75      0.19    2000    0.4229382941
  75     -5.22     46.75      0.19    1000    0.0233752426
  32     -5.12     46.75      0.19     800    0.0759745133
   4     -4.77     46.75      0.19     163    0.1286761194
   3     -4.72     46.75      0.19     158     0.143225385
   4      -4.3     46.75      0.19     138    0.3103123518
   5     -4.27     46.75      0.19     142    0.3297899965
   3     -3.78     46.75      0.19     128    0.5394946831
   4     -3.75     46.75      0.19     124    0.5581890288
   0     -3.25     46.75      0.19     107    0.9027161972
   0     -2.75     46.75      0.19      65    1.2198092629
   0     -2.25     46.75      0.19       8    1.5348188074
   0     -2.23     46.25      0.19      41    1.1403006583
   0     -2.75     46.25      0.19      99    0.8375665995
   3     -3.25     46.25      0.19     123    0.5206434916
   1     -3.72     46.25      0.19     133     0.221112692
   0     -3.75     46.27      0.19     136    0.2225501754
  22     -4.22     46.25      0.19     205    0.1181120828
  21     -4.28     46.25      0.19     237     0.129990854
   0     -4.73     46.25      0.19    2500    0.3346500536
   5     -4.25     47.23      0.19     114     0.718192582
   3     -3.72     47.25      0.19     100    0.9944669778
   0     -3.25     47.25      0.19      64    1.2639918431
;

data Temp;
   set Mackerel;
   Density = Egg_Count/Net_Area;
run;

%let off0 = offsetmin=0 offsetmax=0
            linearopts=(thresholdmin=0 thresholdmax=0);
%let off0 = xaxisopts=(&off0) yaxisopts=(&off0);
proc template;
   define statgraph surface;
      dynamic _title _z;
      begingraph / designwidth=defaultDesignHeight;
         entrytitle _title;
         layout overlay / &off0;
            contourplotparm z=_z y=Latitude x=Longitude / gridded=FALSE;
         endlayout;
      endgraph;
   end;
run;

proc sgrender data=Temp template=surface;
   dynamic _title='Mackerel Egg Density' _z='Density';
run;

data Mackerel;
   set Mackerel;
   Depth = Depth/1000;
   Log_Net_Area = log(Net_Area);
run;

ods graphics on;
proc gampl data=Mackerel plots seed=321;
   model Egg_Count = param(Distance) spline(Depth/maxdf=5)
                     spline(Longitude Latitude/maxdf=40)
                      / offset=Log_Net_Area dist=poisson;
   output out=MackerelOut1 pred=Pred1 pearson=Pea1;
run;

proc gampl data=Mackerel plots seed=321;
   model Egg_Count = param(Distance) spline(Depth/maxdf=5)
                     spline(Longitude Latitude/maxdf=40)
                      / offset=Log_Net_Area dist=negbin;
   output out=MackerelOut2 pred=Pred2 pearson=Pea2;
run;

data SurfaceFit;
   set Mackerel(keep=Longitude Latitude Net_Area Egg_Count);
   set MackerelOut1(keep=Pred1);
   set MackerelOut2(keep=Pred2);
   Pred1 = Pred1 / Net_Area;
   Pred2 = Pred2 / Net_Area;
run;

%let eopt = location=outside valign=top textattrs=graphlabeltext;
proc template;
   define statgraph surfaces;
      begingraph / designheight=360px;
         layout lattice / columns=2;
            layout overlay / &off0;
               entry "Poisson Model" / &eopt;
               contourplotparm z=Pred1 y=Latitude x=Longitude /
                               gridded=FALSE;
            endlayout;
            layout overlay / &off0;
               entry "Negative Binomial Model" / &eopt;
               contourplotparm z=Pred2 y=Latitude x=Longitude /
                               gridded=FALSE;
            endlayout;
         endlayout;
      endgraph;
   end;
run;

proc sgrender data=SurfaceFit template=surfaces;
run;

